<link rel="stylesheet" href="assests/styles.css" />
<script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&amp;display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
<div class="dynamic-page-container" id="dynamicPageContent" style="display: none"></div>

<div class="meeting-page">
  <div class="meeting-screen">
    <div class="meeting-container">
      <div class="content-wrapper">
        <div class="left-column">
          <div class="header-section">
            <div class="date-wrapper">
              <div class="logo">Time</div>
              <div class="current-date">
                <span>Thứ Hai</span>
                <span>10/11/2024</span>
              </div>
            </div>
            <div class="welcome-text">
              <div class="welcome-message">CHÀO MỪNG ĐẾN VỚI PNJ Corp</div>
            </div>
            <div class="rooms-container">
              <div class="room-section">
                <div class="room-number">Lotus</div>
                <div class="room-details">
                  <div class="meeting-info">
                    <div class="meeting-header">
                      <div class="meeting-title">
                        <span>Thông tin cuộc họp: Trống</span>
                      </div>
                      <div class="meeting-time">
                        <div class="time-spacer"></div>
                        <div class="start-time">
                          <span>Thời gian bắt đầu:</span>
                          7:00
                        </div>
                        <div class="end-time">
                          <span>Thời gian kết thúc:</span>
                          9:00
                        </div>
                      </div>
                    </div>
                    <div class="meeting-stats">
                      <div class="stats-row">
                        <div class="temperature">
                          Nhiệt độ: <span id="temperature-eRa"></span>°C
                        </div>
                        <div class="humidity">
                          Độ ẩm: <span id="humidity-eRa"></span>%
                        </div>
                      </div>
                      <div class="stats-row">
                        <div class="current">
                          Dòng điện:<span id="current-eRa"></span>A
                        </div>
                        <div class="power">
                          Công suất: <span id="power-eRa"></span>kWh
                        </div>
                      </div>
                      <div class="status-indicator">
                        <div class="indicator-dot busy"></div>
                        <div class="status-text">Đang họp</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="room-section">
                <div class="room-number">Lavender 1</div>
                <div class="room-details">
                  <div class="meeting-info">
                    <div class="meeting-header">
                      <div class="meeting-title">
                        <span>Thông tin cuộc họp:</span>
                        Trống
                      </div>
                      <div class="meeting-time">
                        <div class="time-spacer"></div>
                        <div class="start-time">
                          <span>Thời gian bắt đầu:</span>
                          --:--
                        </div>
                        <div class="end-time">
                          <span>Thời gian kết thúc:</span>
                          --:--
                        </div>
                      </div>
                    </div>
                    <div class="meeting-stats">
                      <div class="stats-row">
                        <div class="temperature">
                          Nhiệt độ: <span id="temperature-eRa2"></span>°C
                        </div>
                        <div class="humidity">
                          Độ ẩm: <span id="humidity-eRa2"></span>%
                        </div>
                      </div>
                      <div class="stats-row">
                        <div class="current">
                          Dòng điện: <span id="current-eRa2"></span>A
                        </div>
                        <div class="power">
                          Công suất:
                          <span id="power-eRa2"></span>
                          kWh
                        </div>
                      </div>
                      <div class="status-indicator">
                        <div class="indicator-dot available"></div>
                        <div class="status-text">Trống</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="room-section">
                <div class="room-number">Lavender 2</div>
                <div class="room-details">
                  <div class="meeting-info">
                    <div class="meeting-header">
                      <div class="meeting-title">
                        <span>Thông tin cuộc họp:</span>
                        Họp với khách hàng
                      </div>
                      <div class="meeting-time">
                        <div class="time-spacer"></div>
                        <div class="start-time">
                          <span>Thời gian bắt đầu:</span>
                          7:00
                        </div>
                        <div class="end-time">
                          <span>Thời gian kết thúc:</span>
                          9:00
                        </div>
                      </div>
                    </div>
                    <div class="meeting-stats">
                      <div class="stats-row">
                        <div class="temperature">
                          Nhiệt độ:
                          <span id="temperature-eRa3"></span>
                          ℃
                        </div>
                        <div class="humidity">
                          Độ ẩm: <span id="humidity-eRa3"></span>%
                        </div>
                      </div>
                      <div class="stats-row">
                        <div class="current">
                          Dòng điện:
                          <span id="current-eRa3"></span>
                          A
                        </div>
                        <div class="power">
                          Công suất:
                          <span id="power-eRa3"></span>
                          kW
                        </div>
                      </div>
                      <div class="status-indicator">
                        <div class="indicator-dot busy"></div>
                        <div class="status-text">Đang họp</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Thêm phần upload background mới -->
              <!-- Cập nhật HTML -->
              <div class="background-management">
                <div class="settings-icon">
                  <i class="fas fa-cog"></i>
                </div>
                <div class="background-upload-container main-bg-container hidden">
                  <input type="file" id="mainBackgroundUpload" accept="image/*" style="display: none" />
                  <button class="background-upload-button main-background-btn">
                    <div class="button-icon-wrapper">
                      <i class="fas fa-desktop"></i>
                    </div>
                    <span>Background Chính</span>
                  </button>
                </div>

                <div class="background-upload-container schedule-bg-container hidden">
                  <input type="file" id="scheduleBackgroundUpload" accept="image/*" style="display: none" />
                  <button class="background-upload-button schedule-background-btn">
                    <div class="button-icon-wrapper">
                      <i class="fas fa-table"></i>
                    </div>
                    <span>Background Lịch</span>
                  </button>
                </div>

                <button class="reset-background-button hidden">
                  <div class="button-icon-wrapper">
                    <i class="fas fa-undo"></i>
                  </div>
                  <span>Đặt Lại</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="right-column">
          <div class="schedule-section">
            <div class="schedule-content">
              <h1 class="schedule-title">THÔNG TIN LỊCH HỌP</h1>
              <div class="schedule-actions">
                <button class="upload-button">
                  Upload Meeting From
                  <img class="upload-icon"
                    src="https://cdn.builder.io/api/v1/image/assets/TEMP/63b8f295cfd8166b173b26ae08d375f7f940976a41ab185ea145bd917523e537?placeholderIfAbsent=true&apiKey=b0c49e93ca95415e8bbe88f5e7bbd808"
                    alt="Upload icon" />
                </button>
                <input type="date" id="meetingDate" class="date-picker" />
                <img class="upload-icon-date"
                  src="https://cdn.builder.io/api/v1/image/assets/TEMP/c0a4e8a69fa64878bebad21d5087b0ff9a059ee566216f2bb71511caa204eaa7?placeholderIfAbsent=true&apiKey=b0c49e93ca95415e8bbe88f5e7bbd808"
                  alt="Additional action icon" />
              </div>
              <div class="schedule-table" role="table" aria-label="Meeting Schedule">
                <div class="table-header" role="row">
                  <div role="columnheader">TT</div>
                  <div role="columnheader">Ngày</div>
                  <div role="columnheader">Thứ</div>
                  <div role="columnheader">Phòng</div>
                  <div role="columnheader">Giờ bắt đầu</div>
                  <div role="columnheader">Giờ kết thúc</div>
                  <div role="columnheader">Thời gian sử dụng</div>
                  <div role="columnheader">Mục đích sử dụng</div>
                  <div role="columnheader">Nội dung</div>
                </div>
                <div class="table-row" role="row">
                  <div role="cell">1</div>
                  <div role="cell">12/11/2024</div>
                  <div role="cell">Thứ 3</div>
                  <div role="cell">P. 1</div>
                  <div role="cell">7:30</div>
                  <div role="cell">9:30</div>
                  <div role="cell">2:00</div>
                  <div role="cell">Họp</div>
                  <div role="cell">Họp nội bộ</div>
                </div>
                <div class="table-row" role="row">
                  <div role="cell">2</div>
                  <div role="cell">14/11/2024</div>
                  <div role="cell">Thứ 5</div>
                  <div role="cell">P. 2</div>
                  <div role="cell">7:30</div>
                  <div role="cell">17:00</div>
                  <div role="cell">9:30</div>
                  <div role="cell">Đào tạo</div>
                  <div role="cell">Đào tạo</div>
                </div>
              </div>
            </div>
            <div class="fullscreen-toggle">
              <button id="fullscreenBtn" class="fullscreen-button" aria-label="Toggle Fullscreen">
                <i class="fas fa-expand"></i>
              </button>
            </div>
            <div class="room-buttons">
              <button class="room-button" aria-label="Select Room 1">
                <div class="button-content">
                  <div class="button-text">P.1</div>
                </div>
              </button>
              <button class="room-button" aria-label="Select Room 2">
                <div class="button-content">
                  <div class="button-text">P.2</div>
                </div>
              </button>
              <button class="room-button" aria-label="Select Room 3">
                <div class="button-content">
                  <div class="button-text">P.3</div>
                </div>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="window">
  <div class="title-bar">
    <div class="buttons">
      <div class="close"></div>
      <div class="minimize"></div>
      <div class="maximize"></div>
    </div>
    <div class="title">Progress Extracting</div>
  </div>
  <div class="content">
    <p id="progressText">Processing Extract Data...</p>
    <p id="progressStatus">Processing . . .</p>
    <div id="progressContainer" class="progress-bar">
      <div id="progressFill" class="progress"></div>
    </div>
    <div class="button-container">
      <button id="stopUploadBtn">Cancel</button>
    </div>
  </div>
</div>

<script src="https://www.unpkg.com/@eohjsc/era-widget@1.1.3/src/index.js"></script>
<script src="script.js"></script>
<script>
  const eraWidget = new EraWidget();

  // Elements for all rooms
  const airConditioner1 = document.getElementById("temperature-airConditioner");
  const airConditioner2 = document.getElementById("temperature-airConditioner2");
  const airConditioner3 = document.getElementById("temperature-airConditioner3");

  // Temperature state variables
  let currentACTemperature = 20;
  let currentACTemperature2 = 20;
  let currentACTemperature3 = 20;

  // Configuration variables
  let configAirConditioner = null;
  let configAirConditioner2 = null;
  let configAirConditioner3 = null;
  let actionOn = null;
  let actionOff = null;

  eraWidget.init({
    onConfiguration: (configuration) => {
      // Save AC configurations
      configAirConditioner = configuration.realtime_configs[12];
      configAirConditioner2 = configuration.realtime_configs[13];
      configAirConditioner3 = configuration.realtime_configs[14];

      // Save action configurations
      actionOn = configuration.actions[0];
      actionOff = configuration.actions[1];
    },
    onValues: (values) => {
      // Helper function to update temperature displays
      const updateTempDisplays = (acNumber, tempValue) => {
        // Get all temperature displays for this room
        const displays = document.querySelectorAll(`.temperature-air[data-room="room${acNumber}"]`);
        displays.forEach(display => {
          display.textContent = tempValue + "°C";
        });
      };

      // Handle AC 1
      if (configAirConditioner && values[configAirConditioner.id]) {
        const airValue = values[configAirConditioner.id].value;
        currentACTemperature = parseFloat(airValue);
        if (airConditioner1) {
          airConditioner1.textContent = airValue + "°C";
        }
        updateTempDisplays(1, airValue);
      }

      // Handle AC 2
      if (configAirConditioner2 && values[configAirConditioner2.id]) {
        const airValue2 = values[configAirConditioner2.id].value;
        currentACTemperature2 = parseFloat(airValue2);
        if (airConditioner2) {
          airConditioner2.textContent = airValue2 + "°C";
        }
        updateTempDisplays(2, airValue2);
      }

      // Handle AC 3
      if (configAirConditioner3 && values[configAirConditioner3.id]) {
        const airValue3 = values[configAirConditioner3.id].value;
        currentACTemperature3 = parseFloat(airValue3);
        if (airConditioner3) {
          airConditioner3.textContent = airValue3 + "°C";
        }
        updateTempDisplays(3, airValue3);
      }
    }
  });
</script>